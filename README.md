# 物流数据处理项目

## 项目结构

```
logistics/
├── README.md                    # 项目说明文档
├── scripts/                     # Python脚本目录
│   ├── analyze_data.py         # 数据分析脚本
│   ├── analyze_reusable_distances.py  # 距离复用分析
│   ├── analyze_reusable_distances_v2.py
│   ├── batch_fill_data.py      # 批量数据填充
│   ├── check_excel_structure.py # Excel结构检查
│   ├── fill_data.py            # 数据填充
│   ├── fill_distances_to_january.py # 1月份距离填充
│   ├── generate_reusable_json.py # 生成可复用距离JSON
│   ├── process_data.py         # 数据处理
│   ├── verify_batch_data.py    # 批量数据验证
│   ├── verify_data.py          # 数据验证
│   └── verify_filled_data.py   # 已填充数据验证
├── data/                        # 数据文件目录
│   ├── reusable_distances.json # 可复用距离数据
│   ├── 临努1.*.xlsx            # 临时数据文件
│   └── 惠宜选合肥仓*月份对账单.xlsx # 对账单数据
└── docs/                        # 文档目录
    ├── 如何使用logistics-fill-skill.md
    ├── 距离填充完成报告.md
    └── 距离复用分析报告.md
```

## 距离计算规则说明

## 合肥物流数据处理规则

- **固定起点**: 所有合肥出发的车辆始终从"丰树合肥现代综合产业园"出发
- **按车划分**: Excel店名列中的每个合并单元格代表一辆车的完整行程，该单元格内按顺序列出了各个停靠点
- **距离解释**:
  - 合并单元格中第一行的公里数表示"丰树合肥现代综合产业园"到第一站的距离
  - 后续每一行的公里数表示前一站到下一站之间的距离，而不是重新从出发点计算
- **距离复用**: 如果两次出现的某段行程的起止地点完全一致，不论它出现在不同的路线或位置，都可以复用之前记录的公里数

## 江西物流数据处理规则

- **固定起点**: 所有江西出发的车辆起点固定为"惠宜选南昌仓"
- **处理方式**: 按照与合肥相同的规则处理Excel数据

## 通用数据存储格式

- 距离数据存储为 JSON 格式: `{"起点 -> 终点": 距离(km)}`
- 所有距离均为整数或浮点数，单位为公里

## 查询输出约束

- **严格按照路线顺序**: 必须按照"上一站 → 下一站"的顺序查询距离，不能使用从起点直接到中间站点的距离
- **地址名称完全一致**: 返回的地址名称必须与用户提供的完全一致，包括所有前缀（如"共橙一站式超市"、"厉臣便利"等）
- **简洁的格式**:
  - 找到距离: `地址名称-距离km`
  - 未找到距离: `地址名称-?km`
  - 不需要额外的注释或说明

## 标准查询流程和输出格式

当用户提供一车的货运线路时，必须按照以下标准流程处理:

### 处理步骤

1. 识别起点（合肥: 丰树合肥现代综合产业园；江西: 惠宜选南昌仓）
2. 按照"上一站 → 下一站"的顺序逐段查询距离
3. 使用用户提供的完整地址名称（保持原样，包括所有括号、标点符号）
4. 对于找不到的距离段，标记为 `?km`

### 输出格式要求

每次查询必须包含两部分内容:

1. **查询逻辑分析**: 列出每一段的查询过程，包括:
   - 查询的起止点
   - 查询键（JSON中的完整键名）
   - 查询结果（找到: 显示行号和距离；未找到: 标记✗）

2. **最终输出结果**: 按标准格式输出

### 完整输出示例

根据江西物流距离数据，按照路线顺序查询这一车的距离:

**查询逻辑**:
1. **惠宜选南昌仓 → 共橙一站式超市（南昌京东大道店）** - 查询键: `"惠宜选南昌仓 -> 共橙一站式超市（南昌京东大道店）"` - 第372行: 9.1km ✓
2. **共橙一站式超市（南昌京东大道店） → 惠宜选-九江市柴桑店** - 查询键: `"共橙一站式超市（南昌京东大道店） -> 惠宜选-九江市柴桑店"` - 未找到 ✗
3. **惠宜选-九江市柴桑店 → 共橙一站式超市（九江花溪路店）** - 查询键: `"惠宜选-九江市柴桑店 -> 共橙一站式超市（九江花溪路店）"` - 第473行: 17.0km ✓
4. **共橙一站式超市（九江花溪路店） → 共橙一站式超市（瑞昌赤乌大道店）** - 查询键: `"共橙一站式超市（九江花溪路店） -> 共橙一站式超市（瑞昌赤乌大道店）"` - 未找到 ✗

**输出结果**:
```
共橙一站式超市（南昌京东大道店）-9.1km 惠宜选-九江市柴桑店-?km 共橙一站式超市（九江花溪路店）-17.0km 共橙一站式超市（瑞昌赤乌大道店）-?km
```

## 注意事项

- 必须同时提供查询逻辑分析和最终输出结果
- 保持地址名称与用户提供的完全一致
- 每行一个站点及其到达该站点的距离
- 查询逻辑分析帮助用户理解查询过程和验证结果准确性

## 常用指令

- 提取 1.2到1.9的物流店名数据，输出成txt 每车的数据要有空行隔开 输出到txt 即可