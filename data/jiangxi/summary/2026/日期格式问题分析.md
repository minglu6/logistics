# Excel日期格式转换问题分析

## 问题背景

在将 `惠宜选物流对账单--临努--1月(2).xlsx` 转换为模板格式时，日期显示格式需要从数字转换为"1月1日"格式。

## 文件日期存储情况

| 文件 | 日期值 | 数据类型 | number_format |
|------|--------|----------|---------------|
| 源文件 | 46023 | int | General |
| 参考文件 | 46023 | int | General |
| 转换后文件 | 2026-01-01 | datetime | M"月"D"日" |

## Excel日期序列号说明

Excel内部使用序列号存储日期，以1899年12月30日为基准：

| 序列号 | 对应日期 |
|--------|----------|
| 46023 | 2026年1月1日 |
| 46024 | 2026年1月2日 |
| 46025 | 2026年1月3日 |
| 46026 | 2026年1月4日 |
| 46027 | 2026年1月5日 |

## openpyxl日期格式代码

| 格式代码 | 显示效果 |
|----------|----------|
| `M"月"D"日"` | 1月1日 |
| `YYYY/MM/DD` | 2026/01/01 |
| `YYYY-MM-DD` | 2026-01-01 |
| `MM/DD` | 01/01 |
| `General` | 46023（数字） |

## 解决方案

在openpyxl中设置日期格式：

```python
cell = ws.cell(row=r, column=2, value=date_val)
cell.number_format = 'M"月"D"日"'
```

## 注意事项

1. 源文件中的日期是整数类型（Excel序列号），openpyxl读取后保持为int
2. 设置number_format后，Excel会自动将序列号显示为对应的日期格式
3. 参考文件虽然number_format为General，但可能在Excel中手动设置了单元格格式，openpyxl无法完全读取所有格式信息
